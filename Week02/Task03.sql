--USE ships;

--1. ???????? ??????, ????? ??????? ????? ?? ???????? ? ??????????????? ???
--50000.

--SELECT SHIPS.NAME
--FROM SHIPS INNER JOIN CLASSES
--ON SHIPS.CLASS = CLASSES.CLASS
--WHERE CLASSES.DISPLACEMENT > 50000;

--2. ???????? ??????, ????? ??????? ???????, ????????????????? ? ???? ?????? ??
--?????? ??????, ????????? ? ??????? ??? Guadalcanal.

--SELECT SHIPS.NAME, CLASSES.DISPLACEMENT, CLASSES.NUMGUNS
--FROM SHIPS INNER JOIN OUTCOMES
--ON SHIPS.NAME = OUTCOMES.SHIP INNER JOIN CLASSES
--ON SHIPS.CLASS = CLASSES.CLASS
--WHERE OUTCOMES.BATTLE = 'Guadalcanal';

--3. ???????? ??????, ????? ??????? ??????? ?? ???? ???????, ????? ???? ?????
--????? ??????, ???? ? ????? ????????.

--SELECT COUNTRY
--FROM CLASSES 
--WHERE CLASSES.TYPE = 'bb'
--INTERSECT
--SELECT COUNTRY
--FROM CLASSES
--WHERE CLASSES.TYPE = 'bc';

--4. ???????? ??????, ????? ??????? ??????? ?? ???? ??????, ????? ?? ????
--????????? ? ???? ?????, ?? ??-????? ?? ????????? ? ????? ?????.

SELECT O1.SHIP
FROM OUTCOMES AS O1 INNER JOIN BATTLES AS B1
ON O1.BATTLE = B1.NAME INNER JOIN OUTCOMES AS O2
ON O1.SHIP = O2.SHIP INNER JOIN BATTLES AS B2
ON O2.BATTLE = B2.NAME
WHERE O1.RESULT = 'damaged' AND B2.DATE > B1.DATE;